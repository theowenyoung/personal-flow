import { MediaRssFields } from "../types/fields/mod.ts";
export const copyMedia = (source, target) => {
    [
        MediaRssFields.Rating,
        MediaRssFields.Keywords,
        MediaRssFields.Category,
    ].forEach((fieldName) => {
        const val = source[fieldName];
        if (val) {
            target[fieldName] = val.value;
        }
    });
    const mediaGroup = source[MediaRssFields.Group];
    if (mediaGroup && mediaGroup.length > 0) {
        target[MediaRssFields.Group] = mediaGroup.map((group) => {
            return {
                [MediaRssFields.Content]: group[MediaRssFields.Content]?.map((cnt) => ({
                    bitrate: cnt.bitrate,
                    channels: cnt.channels,
                    duration: cnt.duration,
                    expression: cnt.expression,
                    fileSize: cnt.fileSize,
                    height: cnt.height,
                    width: cnt.width,
                    isDefault: cnt.isDefault,
                    lang: cnt.lang,
                    medium: cnt.medium,
                    samplingrate: cnt.samplingrate,
                    type: cnt.type,
                    url: cnt.url,
                })),
            };
        });
    }
    const credit = source[MediaRssFields.Credit];
    if (credit) {
        target[MediaRssFields.Credit] = {
            value: credit.value,
            role: credit.role,
            scheme: credit.scheme,
        };
    }
    const title = source[MediaRssFields.Title];
    if (title) {
        target[MediaRssFields.Title] = {
            value: title.value,
            type: title.type,
        };
    }
    const description = source[MediaRssFields.Description];
    if (description) {
        target[MediaRssFields.Description] = {
            value: description.value,
            type: description.type,
        };
    }
    const content = source[MediaRssFields.Content];
    if (content && content.length > 0) {
        target[MediaRssFields.Content] = content?.map((cnt) => ({
            bitrate: cnt.bitrate,
            channels: cnt.channels,
            duration: cnt.duration,
            expression: cnt.expression,
            fileSize: cnt.fileSize,
            height: cnt.height,
            width: cnt.width,
            isDefault: cnt.isDefault,
            lang: cnt.lang,
            medium: cnt.medium,
            samplingrate: cnt.samplingrate,
            type: cnt.type,
            url: cnt.url,
        }));
    }
    const thumbnails = source[MediaRssFields.Thumbnails];
    if (thumbnails) {
        target[MediaRssFields.Thumbnails] = {
            url: thumbnails.url,
            height: thumbnails.height,
            width: thumbnails.width,
            time: thumbnails.time,
        };
    }
    const hash = source[MediaRssFields.Hash];
    if (hash) {
        target[MediaRssFields.Hash] = {
            value: hash.value,
            algo: hash.algo,
        };
    }
    const player = source[MediaRssFields.Player];
    if (player) {
        target[MediaRssFields.Player] = {
            url: player.url,
            height: player.height,
            width: player.width,
        };
    }
    const copyright = source[MediaRssFields.Copyright];
    if (copyright) {
        target[MediaRssFields.Copyright] = {
            url: copyright.url,
            value: copyright.value,
        };
    }
    const text = source[MediaRssFields.Text];
    if (text) {
        target[MediaRssFields.Text] = {
            value: text.value,
            type: text.value,
            lang: text.value,
            start: text.start,
            end: text.end,
        };
    }
    const restriction = source[MediaRssFields.Restriction];
    if (restriction) {
        target[MediaRssFields.Restriction] = {
            value: restriction.value,
            relationship: restriction.relationship,
            type: restriction.type,
        };
    }
    const comments = source[MediaRssFields.Comments];
    if (comments) {
        target[MediaRssFields.Comments] = {
            "media:comment": comments[MediaRssFields.Comment]?.map((x) => x.value),
        };
    }
    const embed = source[MediaRssFields.Embed];
    if (embed) {
        target[MediaRssFields.Embed] = {
            url: embed.url,
            height: embed.height,
            width: embed.width,
        };
        const mediaParam = embed[MediaRssFields.Param];
        if (mediaParam) {
            target[MediaRssFields.Embed][MediaRssFields.Param] = {
                value: mediaParam?.value,
                name: mediaParam?.name,
            };
        }
    }
    const responses = source[MediaRssFields.Responses];
    if (responses) {
        target[MediaRssFields.Responses] = {
            "media:response": responses[MediaRssFields.Response]?.map((x) => x.value),
        };
    }
    const backLinks = source[MediaRssFields.BackLinks];
    if (backLinks) {
        target[MediaRssFields.BackLinks] = {
            "media:backLink": backLinks[MediaRssFields.BackLink]?.map((x) => x.value),
        };
    }
    const status = source[MediaRssFields.Status];
    if (status) {
        target[MediaRssFields.Status] = {
            state: status.state,
            reason: status.reason,
        };
    }
    const price = source[MediaRssFields.Price];
    if (price) {
        target[MediaRssFields.Price] = {
            type: price.type,
            price: price.price,
            info: price.info,
            currency: price.currency,
        };
    }
    const license = source[MediaRssFields.License];
    if (license) {
        target[MediaRssFields.License] = {
            value: license.value,
            type: license.type,
            href: license.href,
        };
    }
    const subtitle = source[MediaRssFields.Subtitle];
    if (subtitle) {
        target[MediaRssFields.Subtitle] = {
            type: subtitle.type,
            lang: subtitle.lang,
            href: subtitle.href,
        };
    }
    const peerLink = source[MediaRssFields.PeerLink];
    if (peerLink) {
        target[MediaRssFields.PeerLink] = {
            type: peerLink.type,
            href: peerLink.href,
        };
    }
    const rights = source[MediaRssFields.Rights];
    if (rights) {
        target[MediaRssFields.Rights] = {
            status: rights.status,
        };
    }
    const scenes = source[MediaRssFields.Scenes];
    if (scenes) {
        target[MediaRssFields.Scenes] = {
            "media:scene": scenes[MediaRssFields.Scene]?.map((x) => ({
                sceneTitle: x.sceneTitle,
                sceneDescription: x.sceneDescription,
                sceneStartTime: x.sceneStartTime,
                sceneEndTime: x.sceneEndTime,
            })),
        };
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVkaWFfbWFwcGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaHR0cHM6Ly9kZW5vLmxhbmQveC9yc3NAMC41LjUvc3JjL21hcHBlcnMvbWVkaWFfbWFwcGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUl4RCxNQUFNLENBQUMsTUFBTSxTQUFTLEdBQUcsQ0FBQyxNQUF3QixFQUFFLE1BQWdCLEVBQUUsRUFBRTtJQUN0RTtRQUNFLGNBQWMsQ0FBQyxNQUFNO1FBQ3JCLGNBQWMsQ0FBQyxRQUFRO1FBQ3ZCLGNBQWMsQ0FBQyxRQUFRO0tBQ3hCLENBQUMsT0FBTyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUU7UUFDdEIsTUFBTSxHQUFHLEdBQUksTUFBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3ZDLElBQUksR0FBRyxFQUFFO1lBQ04sTUFBYyxDQUFDLFNBQVMsQ0FBQyxHQUFJLEdBQVcsQ0FBQyxLQUFLLENBQUM7U0FDakQ7SUFDSCxDQUFDLENBQUMsQ0FBQztJQUVILE1BQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEQsSUFBSSxVQUFVLElBQUksVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7UUFDdkMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUU7WUFDdEQsT0FBTztnQkFDTCxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsRUFBRSxFQUFFLENBQUMsQ0FBQztvQkFDckUsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPO29CQUNwQixRQUFRLEVBQUUsR0FBRyxDQUFDLFFBQVE7b0JBQ3RCLFFBQVEsRUFBRSxHQUFH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QUN0QixDQUFDO0tBQ0g7SUFFRCxNQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzdDLElBQUksTUFBTSxFQUFFO1FBQ1YsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsR0FBRztZQUM5QixhQUFhLEVBQUUsTUFBTSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ3ZELFVBQVUsRUFBRSxDQUFDLENBQUMsVUFBVTtnQkFDeEIsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDLGdCQUFnQjtnQkFDcEMsY0FBYyxFQUFFLENBQUMsQ0FBQyxjQUFjO2dCQUNoQyxZQUFZLEVBQUUsQ0FBQyxDQUFDLFlBQVk7YUFDN0IsQ0FBQyxDQUFPO1NBQ1YsQ0FBQztLQUNIO0FBQ0gsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTWVkaWFSc3NGaWVsZHMgfSBmcm9tIFwiLi4vdHlwZXMvZmllbGRzL21vZC50c1wiO1xuaW1wb3J0IHR5cGUgeyBJbnRlcm5hbE1lZGlhUnNzIH0gZnJvbSBcIi4uL3R5cGVzL2ludGVybmFsL21vZC50c1wiO1xuaW1wb3J0IHR5cGUgeyBNZWRpYVJzcyB9IGZyb20gXCIuLy4uL3R5cGVzL21lZGlhX3Jzcy50c1wiO1xuXG5leHBvcnQgY29uc3QgY29weU1lZGlhID0gKHNvdXJjZTogSW50ZXJuYWxNZWRpYVJzcywgdGFyZ2V0OiBNZWRpYVJzcykgPT4ge1xuICBbXG4gICAgTWVkaWFSc3NGaWVsZHMuUmF0aW5nLFxuICAgIE1lZGlhUnNzRmllbGRzLktleXdvcmRzLFxuICAgIE1lZGlhUnNzRmllbGRzLkNhdGVnb3J5LFxuICBdLmZvckVhY2goKGZpZWxkTmFtZSkgPT4ge1xuICAgIGNvbnN0IHZhbCA9IChzb3VyY2UgYXMgYW55KVtmaWVsZE5hbWVdO1xuICAgIGlmICh2YWwpIHtcbiAgICAgICh0YXJnZXQgYXMgYW55KVtmaWVsZE5hbWVdID0gKHZhbCBhcyBhbnkpLnZhbHVlO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgbWVkaWFHcm91cCA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5Hcm91cF07XG4gIGlmIChtZWRpYUdyb3VwICYmIG1lZGlhR3JvdXAubGVuZ3RoID4gMCkge1xuICAgIHRhcmdldFtNZWRpYVJzc0ZpZWxkcy5Hcm91cF0gPSBtZWRpYUdyb3VwLm1hcCgoZ3JvdXApID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIFtNZWRpYVJzc0ZpZWxkcy5Db250ZW50XTogZ3JvdXBbTWVkaWFSc3NGaWVsZHMuQ29udGVudF0/Lm1hcCgoY250KSA9PiAoe1xuICAgICAgICAgIGJpdHJhdGU6IGNudC5iaXRyYXRlLFxuICAgICAgICAgIGNoYW5uZWxzOiBjbnQuY2hhbm5lbHMsXG4gICAgICAgICAgZHVyYXRpb246IGNudC5kdXJhdGlvbixcbiAgICAgICAgICBleHByZXNzaW9uOiBjbnQuZXhwcmVzc2lvbixcbiAgICAgICAgICBmaWxlU2l6ZTogY250LmZpbGVTaXplLFxuICAgICAgICAgIGhlaWdodDogY250LmhlaWdodCxcbiAgICAgICAgICB3aWR0aDogY250LndpZHRoLFxuICAgICAgICAgIGlzRGVmYXVsdDogY250LmlzRGVmYXVsdCxcbiAgICAgICAgICBsYW5nOiBjbnQubGFuZyxcbiAgICAgICAgICBtZWRpdW06IGNudC5tZWRpdW0sXG4gICAgICAgICAgc2FtcGxpbmdyYXRlOiBjbnQuc2FtcGxpbmdyYXRlLFxuICAgICAgICAgIHR5cGU6IGNudC50eXBlLFxuICAgICAgICAgIHVybDogY250LnVybCxcbiAgICAgICAgfSkpLFxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IGNyZWRpdCA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5DcmVkaXRdO1xuICBpZiAoY3JlZGl0KSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLkNyZWRpdF0gPSB7XG4gICAgICB2YWx1ZTogY3JlZGl0LnZhbHVlLFxuICAgICAgcm9sZTogY3JlZGl0LnJvbGUsXG4gICAgICBzY2hlbWU6IGNyZWRpdC5zY2hlbWUsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHRpdGxlID0gc291cmNlW01lZGlhUnNzRmllbGRzLlRpdGxlXTtcbiAgaWYgKHRpdGxlKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlRpdGxlXSA9IHtcbiAgICAgIHZhbHVlOiB0aXRsZS52YWx1ZSxcbiAgICAgIHR5cGU6IHRpdGxlLnR5cGUsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gc291cmNlW01lZGlhUnNzRmllbGRzLkRlc2NyaXB0aW9uXTtcbiAgaWYgKGRlc2NyaXB0aW9uKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLkRlc2NyaXB0aW9uXSA9IHtcbiAgICAgIHZhbHVlOiBkZXNjcmlwdGlvbi52YWx1ZSxcbiAgICAgIHR5cGU6IGRlc2NyaXB0aW9uLnR5cGUsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGNvbnRlbnQgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuQ29udGVudF07XG4gIGlmIChjb250ZW50ICYmIGNvbnRlbnQubGVuZ3RoID4gMCkge1xuICAgIHRhcmdldFtNZWRpYVJzc0ZpZWxkcy5Db250ZW50XSA9IGNvbnRlbnQ/Lm1hcCgoY250KSA9PiAoe1xuICAgICAgYml0cmF0ZTogY250LmJpdHJhdGUsXG4gICAgICBjaGFubmVsczogY250LmNoYW5uZWxzLFxuICAgICAgZHVyYXRpb246IGNudC5kdXJhdGlvbixcbiAgICAgIGV4cHJlc3Npb246IGNudC5leHByZXNzaW9uLFxuICAgICAgZmlsZVNpemU6IGNudC5maWxlU2l6ZSxcbiAgICAgIGhlaWdodDogY250LmhlaWdodCxcbiAgICAgIHdpZHRoOiBjbnQud2lkdGgsXG4gICAgICBpc0RlZmF1bHQ6IGNudC5pc0RlZmF1bHQsXG4gICAgICBsYW5nOiBjbnQubGFuZyxcbiAgICAgIG1lZGl1bTogY250Lm1lZGl1bSxcbiAgICAgIHNhbXBsaW5ncmF0ZTogY250LnNhbXBsaW5ncmF0ZSxcbiAgICAgIHR5cGU6IGNudC50eXBlLFxuICAgICAgdXJsOiBjbnQudXJsLFxuICAgIH0pKTtcbiAgfVxuXG4gIGNvbnN0IHRodW1ibmFpbHMgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuVGh1bWJuYWlsc107XG4gIGlmICh0aHVtYm5haWxzKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlRodW1ibmFpbHNdID0ge1xuICAgICAgdXJsOiB0aHVtYm5haWxzLnVybCxcbiAgICAgIGhlaWdodDogdGh1bWJuYWlscy5oZWlnaHQsXG4gICAgICB3aWR0aDogdGh1bWJuYWlscy53aWR0aCxcbiAgICAgIHRpbWU6IHRodW1ibmFpbHMudGltZSxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgaGFzaCA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5IYXNoXTtcbiAgaWYgKGhhc2gpIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuSGFzaF0gPSB7XG4gICAgICB2YWx1ZTogaGFzaC52YWx1ZSxcbiAgICAgIGFsZ286IGhhc2guYWxnbyxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcGxheWVyID0gc291cmNlW01lZGlhUnNzRmllbGRzLlBsYXllcl07XG4gIGlmIChwbGF5ZXIpIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuUGxheWVyXSA9IHtcbiAgICAgIHVybDogcGxheWVyLnVybCxcbiAgICAgIGhlaWdodDogcGxheWVyLmhlaWdodCxcbiAgICAgIHdpZHRoOiBwbGF5ZXIud2lkdGgsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGNvcHlyaWdodCA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5Db3B5cmlnaHRdO1xuICBpZiAoY29weXJpZ2h0KSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLkNvcHlyaWdodF0gPSB7XG4gICAgICB1cmw6IGNvcHlyaWdodC51cmwsXG4gICAgICB2YWx1ZTogY29weXJpZ2h0LnZhbHVlLFxuICAgIH07XG4gIH1cblxuICBjb25zdCB0ZXh0ID0gc291cmNlW01lZGlhUnNzRmllbGRzLlRleHRdO1xuICBpZiAodGV4dCkge1xuICAgIHRhcmdldFtNZWRpYVJzc0ZpZWxkcy5UZXh0XSA9IHtcbiAgICAgIHZhbHVlOiB0ZXh0LnZhbHVlLFxuICAgICAgdHlwZTogdGV4dC52YWx1ZSxcbiAgICAgIGxhbmc6IHRleHQudmFsdWUsXG4gICAgICBzdGFydDogdGV4dC5zdGFydCxcbiAgICAgIGVuZDogdGV4dC5lbmQsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHJlc3RyaWN0aW9uID0gc291cmNlW01lZGlhUnNzRmllbGRzLlJlc3RyaWN0aW9uXTtcbiAgaWYgKHJlc3RyaWN0aW9uKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlJlc3RyaWN0aW9uXSA9IHtcbiAgICAgIHZhbHVlOiByZXN0cmljdGlvbi52YWx1ZSxcbiAgICAgIHJlbGF0aW9uc2hpcDogcmVzdHJpY3Rpb24ucmVsYXRpb25zaGlwLFxuICAgICAgdHlwZTogcmVzdHJpY3Rpb24udHlwZSxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgY29tbWVudHMgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuQ29tbWVudHNdO1xuICBpZiAoY29tbWVudHMpIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuQ29tbWVudHNdID0ge1xuICAgICAgXCJtZWRpYTpjb21tZW50XCI6IGNvbW1lbnRzW01lZGlhUnNzRmllbGRzLkNvbW1lbnRdPy5tYXAoKHgpID0+XG4gICAgICAgIHgudmFsdWVcbiAgICAgICkgYXMgc3RyaW5nW10sXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGVtYmVkID0gc291cmNlW01lZGlhUnNzRmllbGRzLkVtYmVkXTtcbiAgaWYgKGVtYmVkKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLkVtYmVkXSA9IHtcbiAgICAgIHVybDogZW1iZWQudXJsLFxuICAgICAgaGVpZ2h0OiBlbWJlZC5oZWlnaHQsXG4gICAgICB3aWR0aDogZW1iZWQud2lkdGgsXG4gICAgfTtcblxuICAgIGNvbnN0IG1lZGlhUGFyYW0gPSBlbWJlZFtNZWRpYVJzc0ZpZWxkcy5QYXJhbV07XG4gICAgaWYgKG1lZGlhUGFyYW0pIHtcbiAgICAgICh0YXJnZXRbTWVkaWFSc3NGaWVsZHMuRW1iZWRdIGFzIGFueSlbTWVkaWFSc3NGaWVsZHMuUGFyYW1dID0ge1xuICAgICAgICB2YWx1ZTogbWVkaWFQYXJhbT8udmFsdWUsXG4gICAgICAgIG5hbWU6IG1lZGlhUGFyYW0/Lm5hbWUsXG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHJlc3BvbnNlcyA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5SZXNwb25zZXNdO1xuICBpZiAocmVzcG9uc2VzKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlJlc3BvbnNlc10gPSB7XG4gICAgICBcIm1lZGlhOnJlc3BvbnNlXCI6IHJlc3BvbnNlc1tNZWRpYVJzc0ZpZWxkcy5SZXNwb25zZV0/Lm1hcCgoeCkgPT5cbiAgICAgICAgeC52YWx1ZVxuICAgICAgKSBhcyBzdHJpbmdbXSxcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgYmFja0xpbmtzID0gc291cmNlW01lZGlhUnNzRmllbGRzLkJhY2tMaW5rc107XG4gIGlmIChiYWNrTGlua3MpIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuQmFja0xpbmtzXSA9IHtcbiAgICAgIFwibWVkaWE6YmFja0xpbmtcIjogYmFja0xpbmtzW01lZGlhUnNzRmllbGRzLkJhY2tMaW5rXT8ubWFwKCh4KSA9PlxuICAgICAgICB4LnZhbHVlXG4gICAgICApIGFzIHN0cmluZ1tdLFxuICAgIH07XG4gIH1cblxuICBjb25zdCBzdGF0dXMgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuU3RhdHVzXTtcbiAgaWYgKHN0YXR1cykge1xuICAgIHRhcmdldFtNZWRpYVJzc0ZpZWxkcy5TdGF0dXNdID0ge1xuICAgICAgc3RhdGU6IHN0YXR1cy5zdGF0ZSxcbiAgICAgIHJlYXNvbjogc3RhdHVzLnJlYXNvbixcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcHJpY2UgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuUHJpY2VdO1xuICBpZiAocHJpY2UpIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuUHJpY2VdID0ge1xuICAgICAgdHlwZTogcHJpY2UudHlwZSxcbiAgICAgIHByaWNlOiBwcmljZS5wcmljZSxcbiAgICAgIGluZm86IHByaWNlLmluZm8sXG4gICAgICBjdXJyZW5jeTogcHJpY2UuY3VycmVuY3ksXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IGxpY2Vuc2UgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuTGljZW5zZV07XG4gIGlmIChsaWNlbnNlKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLkxpY2Vuc2VdID0ge1xuICAgICAgdmFsdWU6IGxpY2Vuc2UudmFsdWUsXG4gICAgICB0eXBlOiBsaWNlbnNlLnR5cGUsXG4gICAgICBocmVmOiBsaWNlbnNlLmhyZWYsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHN1YnRpdGxlID0gc291cmNlW01lZGlhUnNzRmllbGRzLlN1YnRpdGxlXTtcbiAgaWYgKHN1YnRpdGxlKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlN1YnRpdGxlXSA9IHtcbiAgICAgIHR5cGU6IHN1YnRpdGxlLnR5cGUsXG4gICAgICBsYW5nOiBzdWJ0aXRsZS5sYW5nLFxuICAgICAgaHJlZjogc3VidGl0bGUuaHJlZixcbiAgICB9O1xuICB9XG5cbiAgY29uc3QgcGVlckxpbmsgPSBzb3VyY2VbTWVkaWFSc3NGaWVsZHMuUGVlckxpbmtdO1xuICBpZiAocGVlckxpbmspIHtcbiAgICB0YXJnZXRbTWVkaWFSc3NGaWVsZHMuUGVlckxpbmtdID0ge1xuICAgICAgdHlwZTogcGVlckxpbmsudHlwZSxcbiAgICAgIGhyZWY6IHBlZXJMaW5rLmhyZWYsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHJpZ2h0cyA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5SaWdodHNdO1xuICBpZiAocmlnaHRzKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlJpZ2h0c10gPSB7XG4gICAgICBzdGF0dXM6IHJpZ2h0cy5zdGF0dXMsXG4gICAgfTtcbiAgfVxuXG4gIGNvbnN0IHNjZW5lcyA9IHNvdXJjZVtNZWRpYVJzc0ZpZWxkcy5TY2VuZXNdO1xuICBpZiAoc2NlbmVzKSB7XG4gICAgdGFyZ2V0W01lZGlhUnNzRmllbGRzLlNjZW5lc10gPSB7XG4gICAgICBcIm1lZGlhOnNjZW5lXCI6IHNjZW5lc1tNZWRpYVJzc0ZpZWxkcy5TY2VuZV0/Lm1hcCgoeCkgPT4gKHtcbiAgICAgICAgc2NlbmVUaXRsZTogeC5zY2VuZVRpdGxlLFxuICAgICAgICBzY2VuZURlc2NyaXB0aW9uOiB4LnNjZW5lRGVzY3JpcHRpb24sXG4gICAgICAgIHNjZW5lU3RhcnRUaW1lOiB4LnNjZW5lU3RhcnRUaW1lLFxuICAgICAgICBzY2VuZUVuZFRpbWU6IHguc2NlbmVFbmRUaW1lLFxuICAgICAgfSkpIGFzIFtdLFxuICAgIH07XG4gIH1cbn07XG4iXX0=