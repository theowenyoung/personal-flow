import { Puppeteer, } from "../../vendor/puppeteer-core/puppeteer/common/Puppeteer.js";
import { BrowserFetcher } from "./BrowserFetcher.ts";
import Launcher from "./Launcher.ts";
import { PUPPETEER_REVISIONS } from "../../vendor/puppeteer-core/puppeteer/revisions.js";
export class PuppeteerDeno extends Puppeteer {
    _lazyLauncher;
    __productName;
    _preferredRevision;
    constructor(settings) {
        const { preferredRevision, productName } = settings;
        super();
        this.__productName = productName;
        this._preferredRevision = preferredRevision;
    }
    connect(options) {
        if (options.product)
            this._productName = options.product;
        return super.connect(options);
    }
    get _productName() {
        return this.__productName;
    }
    set _productName(name) {
        if (this.__productName !== name)
            this._changedProduct = true;
        this.__productName = name;
    }
    launch(options = {}) {
        if (options.product)
            this._productName = options.product;
        return this._launcher.launch(options);
    }
    executablePath() {
        return this._launcher.executablePath();
    }
    get _launcher() {
        if (!this._lazyLauncher ||
            this._lazyLauncher.product !== this._productName ||
            this._changedProduct) {
            switch (this._productName) {
                case "firefox":
                    this._preferredRevision = PUPPETEER_REVISIONS.firefox;
                    break;
                case "chrome":
                default:
                    this._preferredRevision = PUPPETEER_REVISIONS.chromium;
            }
            this._changedProduct = false;
            this._lazyLauncher = Launcher(this._preferredRevision, this._productName);
        }
        return this._lazyLauncher;
    }
    get product() {
        return this._launcher.product;
    }
    defaultArgs(options = {}) {
        return this._launcher.defaultArgs(options);
    }
    createBrowserFetcher(options) {
        return new BrowserFetcher(options);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHVwcGV0ZWVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiUHVwcGV0ZWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWdCQSxPQUFPLEVBRUwsU0FBUyxHQUNWLE1BQU0sMkRBQTJELENBQUM7QUFDbkUsT0FBTyxFQUFFLGNBQWMsRUFBeUIsTUFBTSxxQkFBcUIsQ0FBQztBQUk1RSxPQUFPLFFBQTZCLE1BQU0sZUFBZSxDQUFDO0FBQzFELE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLG9EQUFvRCxDQUFDO0FBc0N6RixNQUFNLE9BQU8sYUFBYyxTQUFRLFNBQVM7SUFDbEMsYUFBYSxDQUFtQjtJQUNoQyxhQUFhLENBQVc7SUFJaEMsa0JBQWtCLENBQVM7SUFLM0IsWUFBWSxRQUE4RDtRQUN4RSxNQUFNLEVBQUUsaUJBQWlCLEVBQUUsV0FBVyxFQUFFLEdBQUcsUUFBUSxDQUFDO1FBQ3BELEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxDQUFDLGFBQWEsR0FBRyxXQUFXLENBQUM7UUFDakMsSUFBSSxDQUFDLGtCQUFrQixHQUFHLGlCQUFpQixDQUFDO0lBQzlDLENBQUM7SUFVRCxPQUFPLENBQUMsT0FBdUI7UUFDN0IsSUFBSSxPQUFPLENBQUMsT0FBTztZQUFFLElBQUksQ0FBQyxZQUFZLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztRQUN6RCxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUtELElBQUksWUFBWTtRQUNkLE9BQU8sSUFBSSxDQUFDLGFBQWMsQ0FBQztJQUM3QixDQUFDO0lBR0QsSUFBSSxZQUFZLENBQUMsSUFBYTtRQUM1QixJQUFJLElBQUksQ0FBQyxhQUFhLEtBQUssSUFBSTtZQUFFLElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDO1FBQzdELElBQUksQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO0lBQzVCLENBQUM7SUEyQkQsTUFBTSxDQUNKLFVBS00sRUFBRTtRQUVSLElBQUksT0FBTyxDQUFDLE9BQU87WUFBRSxJQUFJLENBQUMsWUFBWSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDekQsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBWUQsY0FBYztRQUNaLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUN6QyxDQUFDO0lBS0QsSUFBSSxTQUFTO1FBQ1gsSUFDRSxDQUFDLElBQUksQ0FBQyxhQUFhO1lBQ25CLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxLQUFLLElBQUksQ0FBQyxZQUFZO1lBQ2hELElBQUksQ0FBQyxlQUFlLEVBQ3BCO1lBQ0EsUUFBUSxJQUFJLENBQUMsWUFBWSxFQUFFO2dCQUN6QixLQUFLLFNBQVM7b0JBQ1osSUFBSSxDQUFDLGtCQUFrQixHQUFHLG1CQUFtQixDQUFDLE9BQU8sQ0FBQztvQkFDdEQsTUFBTTtnQkFDUixLQUFLLFFBQVEsQ0FBQztnQkFDZDtvQkFDRSxJQUFJLENBQUMsa0JBQWtCLEdBQUcsbUJBQW1CLENBQUMsUUFBUSxDQUFDO2FBQzFEO1lBQ0QsSUFBSSxDQUFDLGVBQWUsR0FBRyxLQUFLLENBQUM7WUFDN0IsSUFBSSxDQUFDLGFBQWEsR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLGtCQUFrQixFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztTQUMzRTtRQUNELE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQztJQUM1QixDQUFDO0lBVUQsSUFBSSxPQUFPO1FBQ1QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQztJQUNoQyxDQUFDO0lBT0QsV0FBVyxDQUFDLFVBQTRCLEVBQUU7UUFDeEMsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBT0Qsb0JBQW9CLENBQUMsT0FBOEI7UUFDakQsT0FBTyxJQUFJLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNyQyxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gIENvbm5lY3RPcHRpb25zLFxuICBQdXBwZXRlZXIsXG59IGZyb20gXCIuLi8uLi92ZW5kb3IvcHVwcGV0ZWVyLWNvcmUvcHVwcGV0ZWVyL2NvbW1vbi9QdXBwZXRlZXIuanNcIjtcbmltcG9ydCB7IEJyb3dzZXJGZXRjaGVyLCBCcm93c2VyRmV0Y2hlck9wdGlvbnMgfSBmcm9tIFwiLi9Ccm93c2VyRmV0Y2hlci50c1wiO1xuaW1wb3J0IHsgQ2hyb21lQXJnT3B0aW9ucywgTGF1bmNoT3B0aW9ucyB9IGZyb20gXCIuL0xhdW5jaE9wdGlvbnMudHNcIjtcbmltcG9ydCB7IEJyb3dzZXJDb25uZWN0T3B0aW9ucyB9IGZyb20gXCIuLi8uLi92ZW5kb3IvcHVwcGV0ZWVyLWNvcmUvcHVwcGV0ZWVyL2NvbW1vbi9Ccm93c2VyQ29ubmVjdG9yLmpzXCI7XG5pbXBvcnQgeyBCcm93c2VyIH0gZnJvbSBcIi4uLy4uL3ZlbmRvci9wdXBwZXRlZXItY29yZS9wdXBwZXRlZXIvY29tbW9uL0Jyb3dzZXIuanNcIjtcbmltcG9ydCBMYXVuY2hlciwgeyBQcm9kdWN0TGF1bmNoZXIgfSBmcm9tIFwiLi9MYXVuY2hlci50c1wiO1xuaW1wb3J0IHsgUFVQUEVURUVSX1JFVklTSU9OUyB9IGZyb20gXCIuLi8uLi92ZW5kb3IvcHVwcGV0ZWVyLWNvcmUvcHVwcGV0ZWVyL3JldmlzaW9ucy5qc1wiO1xuaW1wb3J0IHsgUHJvZHVjdCB9IGZyb20gXCIuLi8uLi92ZW5kb3IvcHVwcGV0ZWVyLWNvcmUvcHVwcGV0ZWVyL2NvbW1vbi9Qcm9kdWN0LmpzXCI7XG5cbi8qKlxuICogRXh0ZW5kcyB0aGUgbWFpbiB7QGxpbmsgUHVwcGV0ZWVyfSBjbGFzcyB3aXRoIE5vZGUgc3BlY2lmaWMgYmVoYXZpb3VyIGZvciBmZXRjaGluZyBhbmRcbiAqIGRvd25sb2FkaW5nIGJyb3dzZXJzLlxuICpcbiAqIElmIHlvdSdyZSB1c2luZyBQdXBwZXRlZXIgaW4gYSBOb2RlIGVudmlyb25tZW50LCB0aGlzIGlzIHRoZSBjbGFzcyB5b3UnbGwgZ2V0XG4gKiB3aGVuIHlvdSBydW4gYHJlcXVpcmUoJ3B1cHBldGVlcicpYCAob3IgdGhlIGVxdWl2YWxlbnQgRVMgYGltcG9ydGApLlxuICpcbiAqIEByZW1hcmtzXG4gKlxuICogVGhlIG1vc3QgY29tbW9uIG1ldGhvZCB0byB1c2UgaXMge0BsaW5rIFB1cHBldGVlckRlbm8ubGF1bmNoIHwgbGF1bmNofSwgd2hpY2hcbiAqIGlzIHVzZWQgdG8gbGF1bmNoIGFuZCBjb25uZWN0IHRvIGEgbmV3IGJyb3dzZXIgaW5zdGFuY2UuXG4gKlxuICogU2VlIHtAbGluayBQdXBwZXRlZXIgfCB0aGUgbWFpbiBQdXBwZXRlZXIgY2xhc3N9IGZvciBtZXRob2RzIGNvbW1vbiB0byBhbGxcbiAqIGVudmlyb25tZW50cywgc3VjaCBhcyB7QGxpbmsgUHVwcGV0ZWVyLmNvbm5lY3R9LlxuICpcbiAqIEBleGFtcGxlXG4gKiBUaGUgZm9sbG93aW5nIGlzIGEgdHlwaWNhbCBleGFtcGxlIG9mIHVzaW5nIFB1cHBldGVlciB0byBkcml2ZSBhdXRvbWF0aW9uOlxuICogYGBganNcbiAqIGNvbnN0IHB1cHBldGVlciA9IHJlcXVpcmUoJ3B1cHBldGVlcicpO1xuICpcbiAqIChhc3luYyAoKSA9PiB7XG4gKiAgIGNvbnN0IGJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXIubGF1bmNoKCk7XG4gKiAgIGNvbnN0IHBhZ2UgPSBhd2FpdCBicm93c2VyLm5ld1BhZ2UoKTtcbiAqICAgYXdhaXQgcGFnZS5nb3RvKCdodHRwczovL3d3dy5nb29nbGUuY29tJyk7XG4gKiAgIC8vIG90aGVyIGFjdGlvbnMuLi5cbiAqICAgYXdhaXQgYnJvd3Nlci5jbG9zZSgpO1xuICogfSkoKTtcbiAqIGBgYFxuICpcbiAqIE9uY2UgeW91IGhhdmUgY3JlYXRlZCBhIGBwYWdlYCB5b3UgaGF2ZSBhY2Nlc3MgdG8gYSBsYXJnZSBBUEkgdG8gaW50ZXJhY3RcbiAqIHdpdGggdGhlIHBhZ2UsIG5hdmlnYXRlLCBvciBmaW5kIGNlcnRhaW4gZWxlbWVudHMgaW4gdGhhdCBwYWdlLlxuICogVGhlIHtAbGluayBQYWdlIHwgYHBhZ2VgIGRvY3VtZW50YXRpb259IGxpc3RzIGFsbCB0aGUgYXZhaWxhYmxlIG1ldGhvZHMuXG4gKlxuICogQHB1YmxpY1xuICovXG5leHBvcnQgY2xhc3MgUHVwcGV0ZWVyRGVubyBleHRlbmRzIFB1cHBldGVlciB7XG4gIHByaXZhdGUgX2xhenlMYXVuY2hlciE6IFByb2R1Y3RMYXVuY2hlcjtcbiAgcHJpdmF0ZSBfX3Byb2R1Y3ROYW1lPzogUHJvZHVjdDtcbiAgLyoqXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgX3ByZWZlcnJlZFJldmlzaW9uOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEBpbnRlcm5hbFxuICAgKi9cbiAgY29uc3RydWN0b3Ioc2V0dGluZ3M6IHsgcHJlZmVycmVkUmV2aXNpb246IHN0cmluZzsgcHJvZHVjdE5hbWU/OiBQcm9kdWN0IH0pIHtcbiAgICBjb25zdCB7IHByZWZlcnJlZFJldmlzaW9uLCBwcm9kdWN0TmFtZSB9ID0gc2V0dGluZ3M7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9fcHJvZHVjdE5hbWUgPSBwcm9kdWN0TmFtZTtcbiAgICB0aGlzLl9wcmVmZXJyZWRSZXZpc2lvbiA9IHByZWZlcnJlZFJldmlzaW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoaXMgbWV0aG9kIGF0dGFjaGVzIFB1cHBldGVlciB0byBhbiBleGlzdGluZyBicm93c2VyIGluc3RhbmNlLlxuICAgKlxuICAgKiBAcmVtYXJrc1xuICAgKlxuICAgKiBAcGFyYW0gb3B0aW9ucyAtIFNldCBvZiBjb25maWd1cmFibGUgb3B0aW9ucyB0byBzZXQgb24gdGhlIGJyb3dzZXIuXG4gICAqIEByZXR1cm5zIFByb21pc2Ugd2hpY2ggcmVzb2x2ZXMgdG8gYnJvd3NlciBpbnN0YW5jZS5cbiAgICovXG4gIGNvbm5lY3Qob3B0aW9uczogQ29ubmVjdE9wdGlvbnMpOiBQcm9taXNlPEJyb3dzZXI+IHtcbiAgICBpZiAob3B0aW9ucy5wcm9kdWN0KSB0aGlzLl9wcm9kdWN0TmFtZSA9IG9wdGlvbnMucHJvZHVjdDtcbiAgICByZXR1cm4gc3VwZXIuY29ubmVjdChvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIGdldCBfcHJvZHVjdE5hbWUoKTogUHJvZHVjdCB7XG4gICAgcmV0dXJuIHRoaXMuX19wcm9kdWN0TmFtZSE7XG4gIH1cblxuICAvLyBkb24ndCBuZWVkIGFueSBUU0RvYyBoZXJlIC0gYmVjYXVzZSB0aGUgZ2V0dGVyIGlzIGludGVybmFsIHRoZSBzZXR0ZXIgaXMgdG9vLlxuICBzZXQgX3Byb2R1Y3ROYW1lKG5hbWU6IFByb2R1Y3QpIHtcbiAgICBpZiAodGhpcy5fX3Byb2R1Y3ROYW1lICE9PSBuYW1lKSB0aGlzLl9jaGFuZ2VkUHJvZHVjdCA9IHRydWU7XG4gICAgdGhpcy5fX3Byb2R1Y3ROYW1lID0gbmFtZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMYXVuY2hlcyBwdXBwZXRlZXIgYW5kIGxhdW5jaGVzIGEgYnJvd3NlciBpbnN0YW5jZSB3aXRoIGdpdmVuIGFyZ3VtZW50c1xuICAgKiBhbmQgb3B0aW9ucyB3aGVuIHNwZWNpZmllZC5cbiAgICpcbiAgICogQHJlbWFya3NcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogWW91IGNhbiB1c2UgYGlnbm9yZURlZmF1bHRBcmdzYCB0byBmaWx0ZXIgb3V0IGAtLW11dGUtYXVkaW9gIGZyb20gZGVmYXVsdCBhcmd1bWVudHM6XG4gICAqIGBgYGpzXG4gICAqIGNvbnN0IGJyb3dzZXIgPSBhd2FpdCBwdXBwZXRlZXIubGF1bmNoKHtcbiAgICogICBpZ25vcmVEZWZhdWx0QXJnczogWyctLW11dGUtYXVkaW8nXVxuICAgKiB9KTtcbiAgICogYGBgXG4gICAqXG4gICAqICoqTk9URSoqIFB1cHBldGVlciBjYW4gYWxzbyBiZSB1c2VkIHRvIGNvbnRyb2wgdGhlIENocm9tZSBicm93c2VyLFxuICAgKiBidXQgaXQgd29ya3MgYmVzdCB3aXRoIHRoZSB2ZXJzaW9uIG9mIENocm9taXVtIGl0IGlzIGJ1bmRsZWQgd2l0aC5cbiAgICogVGhlcmUgaXMgbm8gZ3VhcmFudGVlIGl0IHdpbGwgd29yayB3aXRoIGFueSBvdGhlciB2ZXJzaW9uLlxuICAgKiBVc2UgYGV4ZWN1dGFibGVQYXRoYCBvcHRpb24gd2l0aCBleHRyZW1lIGNhdXRpb24uXG4gICAqIElmIEdvb2dsZSBDaHJvbWUgKHJhdGhlciB0aGFuIENocm9taXVtKSBpcyBwcmVmZXJyZWQsIGEge0BsaW5rIGh0dHBzOi8vd3d3Lmdvb2dsZS5jb20vY2hyb21lL2Jyb3dzZXIvY2FuYXJ5Lmh0bWwgfCBDaHJvbWUgQ2FuYXJ5fSBvciB7QGxpbmsgaHR0cHM6Ly93d3cuY2hyb21pdW0ub3JnL2dldHRpbmctaW52b2x2ZWQvZGV2LWNoYW5uZWwgfCBEZXYgQ2hhbm5lbH0gYnVpbGQgaXMgc3VnZ2VzdGVkLlxuICAgKiBJbiBgcHVwcGV0ZWVyLmxhdW5jaChbb3B0aW9uc10pYCwgYW55IG1lbnRpb24gb2YgQ2hyb21pdW0gYWxzbyBhcHBsaWVzIHRvIENocm9tZS5cbiAgICogU2VlIHtAbGluayBodHRwczovL3d3dy5ob3d0b2dlZWsuY29tLzIwMjgyNS93aGF0JUUyJTgwJTk5cy10aGUtZGlmZmVyZW5jZS1iZXR3ZWVuLWNocm9taXVtLWFuZC1jaHJvbWUvIHwgdGhpcyBhcnRpY2xlfSBmb3IgYSBkZXNjcmlwdGlvbiBvZiB0aGUgZGlmZmVyZW5jZXMgYmV0d2VlbiBDaHJvbWl1bSBhbmQgQ2hyb21lLiB7QGxpbmsgaHR0cHM6Ly9jaHJvbWl1bS5nb29nbGVzb3VyY2UuY29tL2Nocm9taXVtL3NyYy8rL2xrZ3IvZG9jcy9jaHJvbWl1bV9icm93c2VyX3ZzX2dvb2dsZV9jaHJvbWUubWQgfCBUaGlzIGFydGljbGV9IGRlc2NyaWJlcyBzb21lIGRpZmZlcmVuY2VzIGZvciBMaW51eCB1c2Vycy5cbiAgICpcbiAgICogQHBhcmFtIG9wdGlvbnMgLSBTZXQgb2YgY29uZmlndXJhYmxlIG9wdGlvbnMgdG8gc2V0IG9uIHRoZSBicm93c2VyLlxuICAgKiBAcmV0dXJucyBQcm9taXNlIHdoaWNoIHJlc29sdmVzIHRvIGJyb3dzZXIgaW5zdGFuY2UuXG4gICAqL1xuICBsYXVuY2goXG4gICAgb3B0aW9uczogTGF1bmNoT3B0aW9ucyAmXG4gICAgICBDaHJvbWVBcmdPcHRpb25zICZcbiAgICAgIEJyb3dzZXJDb25uZWN0T3B0aW9ucyAmIHtcbiAgICAgICAgcHJvZHVjdD86IFByb2R1Y3Q7XG4gICAgICAgIGV4dHJhUHJlZnNGaXJlZm94PzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gICAgICB9ID0ge31cbiAgKTogUHJvbWlzZTxCcm93c2VyPiB7XG4gICAgaWYgKG9wdGlvbnMucHJvZHVjdCkgdGhpcy5fcHJvZHVjdE5hbWUgPSBvcHRpb25zLnByb2R1Y3Q7XG4gICAgcmV0dXJuIHRoaXMuX2xhdW5jaGVyLmxhdW5jaChvcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmVtYXJrc1xuICAgKlxuICAgKiAqKk5PVEUqKiBgcHVwcGV0ZWVyLmV4ZWN1dGFibGVQYXRoKClgIGlzIGFmZmVjdGVkIGJ5IHRoZSBgUFVQUEVURUVSX0VYRUNVVEFCTEVfUEFUSGBcbiAgICogYW5kIGBQVVBQRVRFRVJfQ0hST01JVU1fUkVWSVNJT05gIGVudmlyb25tZW50IHZhcmlhYmxlcy5cbiAgICpcbiAgICogQHJldHVybnMgQSBwYXRoIHdoZXJlIFB1cHBldGVlciBleHBlY3RzIHRvIGZpbmQgdGhlIGJ1bmRsZWQgYnJvd3Nlci5cbiAgICogVGhlIGJyb3dzZXIgYmluYXJ5IG1pZ2h0IG5vdCBiZSB0aGVyZSBpZiB0aGUgZG93bmxvYWQgd2FzIHNraXBwZWQgd2l0aFxuICAgKiB0aGUgYFBVUFBFVEVFUl9TS0lQX0RPV05MT0FEYCBlbnZpcm9ubWVudCB2YXJpYWJsZS5cbiAgICovXG4gIGV4ZWN1dGFibGVQYXRoKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2xhdW5jaGVyLmV4ZWN1dGFibGVQYXRoKCk7XG4gIH1cblxuICAvKipcbiAgICogQGludGVybmFsXG4gICAqL1xuICBnZXQgX2xhdW5jaGVyKCk6IFByb2R1Y3RMYXVuY2hlciB7XG4gICAgaWYgKFxuICAgICAgIXRoaXMuX2xhenlMYXVuY2hlciB8fFxuICAgICAgdGhpcy5fbGF6eUxhdW5jaGVyLnByb2R1Y3QgIT09IHRoaXMuX3Byb2R1Y3ROYW1lIHx8XG4gICAgICB0aGlzLl9jaGFuZ2VkUHJvZHVjdFxuICAgICkge1xuICAgICAgc3dpdGNoICh0aGlzLl9wcm9kdWN0TmFtZSkge1xuICAgICAgICBjYXNlIFwiZmlyZWZveFwiOlxuICAgICAgICAgIHRoaXMuX3ByZWZlcnJlZFJldmlzaW9uID0gUFVQUEVURUVSX1JFVklTSU9OUy5maXJlZm94O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiY2hyb21lXCI6XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhpcy5fcHJlZmVycmVkUmV2aXNpb24gPSBQVVBQRVRFRVJfUkVWSVNJT05TLmNocm9taXVtO1xuICAgICAgfVxuICAgICAgdGhpcy5fY2hhbmdlZFByb2R1Y3QgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2xhenlMYXVuY2hlciA9IExhdW5jaGVyKHRoaXMuX3ByZWZlcnJlZFJldmlzaW9uLCB0aGlzLl9wcm9kdWN0TmFtZSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9sYXp5TGF1bmNoZXI7XG4gIH1cblxuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGJyb3dzZXIgdGhhdCBpcyB1bmRlciBhdXRvbWF0aW9uIChgXCJjaHJvbWVcImAgb3IgYFwiZmlyZWZveFwiYClcbiAgICpcbiAgICogQHJlbWFya3NcbiAgICogVGhlIHByb2R1Y3QgaXMgc2V0IGJ5IHRoZSBgUFVQUEVURUVSX1BST0RVQ1RgIGVudmlyb25tZW50IHZhcmlhYmxlIG9yIHRoZSBgcHJvZHVjdGBcbiAgICogb3B0aW9uIGluIGBwdXBwZXRlZXIubGF1bmNoKFtvcHRpb25zXSlgIGFuZCBkZWZhdWx0cyB0byBgY2hyb21lYC5cbiAgICogRmlyZWZveCBzdXBwb3J0IGlzIGV4cGVyaW1lbnRhbC5cbiAgICovXG4gIGdldCBwcm9kdWN0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2xhdW5jaGVyLnByb2R1Y3Q7XG4gIH1cblxuICAvKipcbiAgICpcbiAgICogQHBhcmFtIG9wdGlvbnMgLSBTZXQgb2YgY29uZmlndXJhYmxlIG9wdGlvbnMgdG8gc2V0IG9uIHRoZSBicm93c2VyLlxuICAgKiBAcmV0dXJucyBUaGUgZGVmYXVsdCBmbGFncyB0aGF0IENocm9taXVtIHdpbGwgYmUgbGF1bmNoZWQgd2l0aC5cbiAgICovXG4gIGRlZmF1bHRBcmdzKG9wdGlvbnM6IENocm9tZUFyZ09wdGlvbnMgPSB7fSk6IHN0cmluZ1tdIHtcbiAgICByZXR1cm4gdGhpcy5fbGF1bmNoZXIuZGVmYXVsdEFyZ3Mob3B0aW9ucyk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIG9wdGlvbnMgLSBTZXQgb2YgY29uZmlndXJhYmxlIG9wdGlvbnMgdG8gc3BlY2lmeSB0aGUgc2V0dGluZ3NcbiAgICogb2YgdGhlIEJyb3dzZXJGZXRjaGVyLlxuICAgKiBAcmV0dXJucyBBIG5ldyBCcm93c2VyRmV0Y2hlciBpbnN0YW5jZS5cbiAgICovXG4gIGNyZWF0ZUJyb3dzZXJGZXRjaGVyKG9wdGlvbnM6IEJyb3dzZXJGZXRjaGVyT3B0aW9ucyk6IEJyb3dzZXJGZXRjaGVyIHtcbiAgICByZXR1cm4gbmV3IEJyb3dzZXJGZXRjaGVyKG9wdGlvbnMpO1xuICB9XG59XG4iXX0=