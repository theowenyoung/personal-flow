import * as path from "https://deno.land/std/path/mod.ts";
function _determineMimeType(filePath) {
    const fileExtension = path.extname(filePath);
    switch (fileExtension) {
        case ".aac": return "audio/aac";
        case ".abw": return "application/x-abiword";
        case ".arc": return "application/x-freearc";
        case ".avi": return "video/x-msvideo";
        case ".azw": return "application/vnd.amazon.ebook";
        case ".bin": return "application/octet-stream";
        case ".bmp": return "image/bmp";
        case ".bz": return "application/x-bzip";
        case ".bz2": return "application/x-bzip2";
        case ".csh": return "application/x-csh";
        case ".css": return "text/css";
        case ".csv": return "text/csv";
        case ".doc": return "application/msword";
        case ".docx": return "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
        case ".eot": return "application/vnd.ms-fontobject";
        case ".epub": return "application/epub+zip";
        case ".gz": return "application/gzip";
        case ".gif": return "image/gif";
        case ".htm": return "text/html";
        case ".html": return "text/html";
        case ".ico": return "image/vnd.microsoft.icon";
        case ".ics": return "text/calendar";
        case ".jar": return "application/java-archive";
        case ".jpeg": return "image/jpeg";
        case ".jpg": return "image/jpeg";
        case ".js": return "text/javascript";
        case ".json": return "application/json";
        case ".jsonld": return "application/ld+json";
        case ".mid": return "audio/midi";
        case ".midi": return "audio/midi";
        case ".mjs": return "text/javascript";
        case ".mp3": return "audio/mpeg";
        case ".mpeg": return "video/mpeg";
        case ".mpkg": return "application/vnd.apple.installer+xml";
        case ".odp": return "application/vnd.oasis.opendocument.presentation";
        case ".ods": return "application/vnd.oasis.opendocument.spreadsheet";
        case ".odt": return "application/vnd.oasis.opendocument.text";
        case ".oga": return "audio/ogg";
        case ".ogv": return "video/ogg";
        case ".ogx": return "application/ogg";
        case ".opus": return "audio/opus";
        case ".otf": return "font/otf";
        case ".png": return "image/png";
        case ".pdf": return "application/pdf";
        case ".php": return "application/php";
        case ".ppt": return "application/vnd.ms-powerpoint";
        case ".pptx": return "application/vnd.openxmlformats-officedocument.presentationml.presentation";
        case ".rar": return "application/vnd.rar";
        case ".rtf": return "application/rtf";
        case ".sh": return "application/x-sh";
        case ".svg": return "image/svg+xml";
        case ".swf": return "application/x-shockwave-flash";
        case ".tar": return "application/x-tar";
        case ".tif": return "image/tiff";
        case ".tiff": return "image/tiff";
        case ".ts": return "video/mp2t";
        case ".ttf": return "font/ttf";
        case ".txt": return "text/plain";
        case ".vsd": return "application/vnd.visio";
        case ".wav": return "audio/wav";
        case ".weba": return "audio/webm";
        case ".webm": return "video/webm";
        case ".webp": return "image/webp";
        case ".woff": return "font/woff";
        case ".woff2": return "font/woff2";
        case ".xhtml": return "application/xhtml+xml";
        case ".xls": return "application/vnd.ms-excel";
        case ".xlsx": return "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
        case ".xml": return "application/xml";
        case ".xul": return "application/vnd.mozilla.xul+xml";
        case ".zip": return "application/zip";
        case ".3gp": return "video/3gpp";
        case ".3g2": return "video/3gpp2";
        case ".7z": return "application/x-7z-compressed";
    }
    throw new Error("File extension has no known mimetype");
}
function _encodeU8intToBase64String(uint8arr) {
    const CHUNK_SIZE = 0x8000;
    const charArray = [];
    for (let i = 0; i < uint8arr.length; i += CHUNK_SIZE) {
        charArray.push(String.fromCharCode.apply(null, uint8arr.subarray(i, i + CHUNK_SIZE)));
    }
    return btoa(charArray.join(""));
}
function _convertStringToUint8(str) {
    return new Uint8Array(new TextEncoder().encode(str));
}
function _decodeBase64Bytes(bytes) {
    return new TextDecoder().decode(Uint8Array.from(atob(new TextDecoder().decode(bytes)), c => c.charCodeAt(0)));
}
function _decodeBase64BytesToUint8(bytes) {
    return Uint8Array.from(atob(new TextDecoder().decode(bytes)), c => c.charCodeAt(0));
}
export class Base64 {
    bytes;
    mime;
    isBase64Encoded;
    constructor(data) {
        this.bytes = data.bytes;
        this.mime = data.mime;
        this.isBase64Encoded = data.isBase64Encoded;
    }
    static fromString(unencodedString) {
        return new Base64({
            bytes: _convertStringToUint8(unencodedString),
            mime: null,
            isBase64Encoded: false,
        });
    }
    static fromBase64String(encodedString) {
        return new Base64({
            bytes: _convertStringToUint8(encodedString),
            mime: null,
            isBase64Encoded: true,
        });
    }
    static fromUint8Array(uint8arr) {
        return new Base64({
            bytes: uint8arr,
            mime: null,
            isBase64Encoded: false,
        });
    }
    static fromBase64Uint8Array(uint8arr) {
        return new Base64({
            bytes: uint8arr,
            mime: null,
            isBase64Encoded: true,
        });
    }
    static fromFile(filePath) {
        return new Base64({
            bytes: Deno.readFileSync(filePath),
            mime: `data:${_determineMimeType(filePath)};base64,`,
            isBase64Encoded: false,
        });
    }
    static fromBase64File(filePath) {
        return new Base64({
            bytes: Deno.readFileSync(filePath),
            mime: null,
            isBase64Encoded: true,
        });
    }
    toString() {
        if (this.isBase64Encoded) {
            return _decodeBase64Bytes(this.bytes);
        }
        else {
            return _encodeU8intToBase64String(this.bytes);
        }
    }
    toStringWithMime() {
        if (this.mime) {
            if (this.isBase64Encoded) {
                return _decodeBase64Bytes(this.bytes);
            }
            else {
                return this.mime + _encodeU8intToBase64String(this.bytes);
            }
        }
        else {
            if (this.isBase64Encoded) {
                return _decodeBase64Bytes(this.bytes);
            }
            else {
                return _encodeU8intToBase64String(this.bytes);
            }
        }
    }
    toFile(filePath) {
        if (this.isBase64Encoded) {
            Deno.writeFileSync(filePath, _decodeBase64BytesToUint8(this.bytes));
        }
        else {
            Deno.writeFileSync(filePath, new TextEncoder().encode(_encodeU8intToBase64String(this.bytes)));
        }
    }
    toFileWithMime(filePath) {
        if (!this.mime) {
            this.toFile(filePath);
        }
        else {
            Deno.writeFileSync(filePath, new TextEncoder().encode(this.mime + _encodeU8intToBase64String(this.bytes)));
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxJQUFJLE1BQU0sbUNBQW1DLENBQUM7QUFXMUQsU0FBUyxrQkFBa0IsQ0FBQyxRQUFnQjtJQUMzQyxNQUFNLGFBQWEsR0FBVyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBRXJELFFBQVEsYUFBYSxFQUFFO1FBQ3RCLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyxXQUFXLENBQUM7UUFDaEMsS0FBSyxNQUFNLENBQUMsQ0FBQyxPQUFPLHVCQUF1QixDQUFDO1FBQzVDLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyx1QkFBdUIsQ0FBQztRQUM1QyxLQUFLLE1BQU0sQ0FBQyxDQUFDLE9BQU8saUJBQWlCLENBQUM7UUFDdEMsS0FBSyxNQUFNLENBQUMsQ0FBQyxPQUFPLDhCQUE4QixDQUFDO1FBQ25ELEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTywwQkFBMEIsQ0FBQztRQUMvQyxLQUFLLE1BQU0sQ0FBQyxDQUFDLE9BQU8sV0FBVyxDQUFDO1FBQ2hDLEtBQUssS0FBSyxDQUFDLENBQUMsT0FBTyxvQkFBb0IsQ0FBQztRQUN4QyxLQUFLLE1BQU0sQ0FBQyxDQUFDLE9BQU8scUJBQXFCLENBQUM7UUFDMUMsS0FBSyxNQUFNLENBQUMsQ0FBQyxPQUFPLG1CQUFtQixDQUFDO1FBQ3hDLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTyxVQUFVLENBQUM7UUFDL0IsS0FBSyxNQUFNLENBQUMsQ0FBQyxPQUFPLFVBQVUsQ0FBQztRQUMvQixLQUFLLE1BQU0sQ0FBQyxDQUFDLE9BQU8sb0JBQW9CLENBQUM7UUFDekMsS0FBSyxPQUFPLENBQUMsQ0FBQyxPQUFPLHlFQUF5RSxDQUFDO1FBQy9GLEtBQUssTUFBTSxDQUFDLENBQUMsT0FBTywrQkFBK0IsQ0FBQztRQUNwRCxLQUFLLE9BQU8sQ0FBQyxDQUFDLE9BQU8s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QUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQy9GO0lBQ0YsQ0FBQztJQVdNLGNBQWMsQ0FBQyxRQUFnQjtRQUNyQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRTtZQUNmLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUM7U0FDdEI7YUFBTTtZQUNOLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLElBQUksV0FBVyxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsMEJBQTBCLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUMzRztJQUNGLENBQUM7Q0FDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhdGggZnJvbSBcImh0dHBzOi8vZGVuby5sYW5kL3N0ZC9wYXRoL21vZC50c1wiO1xuXG5cbi8qKlxuICogRGV0ZXJtaW5lcyB0aGUgTUlNRSB0eXBlIGZyb20gYSBmaWxlIGV4dGVuc2lvbi5cbiAqXG4gKiBAcHJpdmF0ZVxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlUGF0aCBpcyB0aGUgcGF0aCB0byBhIGZpbGVcbiAqIEByZXR1cm5zIHtzdHJpbmd9IHRoZSBNSU1FIHR5cGVcbiAqL1xuZnVuY3Rpb24gX2RldGVybWluZU1pbWVUeXBlKGZpbGVQYXRoOiBzdHJpbmcpIDogc3RyaW5nIHtcblx0Y29uc3QgZmlsZUV4dGVuc2lvbjogc3RyaW5nID0gcGF0aC5leHRuYW1lKGZpbGVQYXRoKTtcblxuXHRzd2l0Y2ggKGZpbGVFeHRlbnNpb24pIHtcblx0XHRjYXNlIFwiLmFhY1wiOiByZXR1cm4gXCJhdWRpby9hYWNcIjtcblx0XHRjYXNlIFwiLmFid1wiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LWFiaXdvcmRcIjtcblx0XHRjYXNlIFwiLmFyY1wiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LWZyZWVhcmNcIjtcblx0XHRjYXNlIFwiLmF2aVwiOiByZXR1cm4gXCJ2aWRlby94LW1zdmlkZW9cIjtcblx0XHRjYXNlIFwiLmF6d1wiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQuYW1hem9uLmVib29rXCI7XG5cdFx0Y2FzZSBcIi5iaW5cIjogcmV0dXJuIFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCI7XG5cdFx0Y2FzZSBcIi5ibXBcIjogcmV0dXJuIFwiaW1hZ2UvYm1wXCI7XG5cdFx0Y2FzZSBcIi5ielwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LWJ6aXBcIjtcblx0XHRjYXNlIFwiLmJ6MlwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LWJ6aXAyXCI7XG5cdFx0Y2FzZSBcIi5jc2hcIjogcmV0dXJuIFwiYXBwbGljYXRpb24veC1jc2hcIjtcblx0XHRjYXNlIFwiLmNzc1wiOiByZXR1cm4gXCJ0ZXh0L2Nzc1wiO1xuXHRcdGNhc2UgXCIuY3N2XCI6IHJldHVybiBcInRleHQvY3N2XCI7XG5cdFx0Y2FzZSBcIi5kb2NcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vbXN3b3JkXCI7XG5cdFx0Y2FzZSBcIi5kb2N4XCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC53b3JkcHJvY2Vzc2luZ21sLmRvY3VtZW50XCI7XG5cdFx0Y2FzZSBcIi5lb3RcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3RcIjtcblx0XHRjYXNlIFwiLmVwdWJcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vZXB1Yit6aXBcIjtcblx0XHRjYXNlIFwiLmd6XCI6IHJldHVybiBcImFwcGxpY2F0aW9uL2d6aXBcIjtcblx0XHRjYXNlIFwiLmdpZlwiOiByZXR1cm4gXCJpbWFnZS9naWZcIjtcblx0XHRjYXNlIFwiLmh0bVwiOiByZXR1cm4gXCJ0ZXh0L2h0bWxcIjtcblx0XHRjYXNlIFwiLmh0bWxcIjogcmV0dXJuIFwidGV4dC9odG1sXCI7XG5cdFx0Y2FzZSBcIi5pY29cIjogcmV0dXJuIFwiaW1hZ2Uvdm5kLm1pY3Jvc29mdC5pY29uXCI7XG5cdFx0Y2FzZSBcIi5pY3NcIjogcmV0dXJuIFwidGV4dC9jYWxlbmRhclwiO1xuXHRcdGNhc2UgXCIuamFyXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL2phdmEtYXJjaGl2ZVwiO1xuXHRcdGNhc2UgXCIuanBlZ1wiOiByZXR1cm4gXCJpbWFnZS9qcGVnXCI7XG5cdFx0Y2FzZSBcIi5qcGdcIjogcmV0dXJuIFwiaW1hZ2UvanBlZ1wiO1xuXHRcdGNhc2UgXCIuanNcIjogcmV0dXJuIFwidGV4dC9qYXZhc2NyaXB0XCI7XG5cdFx0Y2FzZSBcIi5qc29uXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL2pzb25cIjtcblx0XHRjYXNlIFwiLmpzb25sZFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi9sZCtqc29uXCI7XG5cdFx0Y2FzZSBcIi5taWRcIjogcmV0dXJuIFwiYXVkaW8vbWlkaVwiO1xuXHRcdGNhc2UgXCIubWlkaVwiOiByZXR1cm4gXCJhdWRpby9taWRpXCI7XG5cdFx0Y2FzZSBcIi5tanNcIjogcmV0dXJuIFwidGV4dC9qYXZhc2NyaXB0XCI7XG5cdFx0Y2FzZSBcIi5tcDNcIjogcmV0dXJuIFwiYXVkaW8vbXBlZ1wiO1xuXHRcdGNhc2UgXCIubXBlZ1wiOiByZXR1cm4gXCJ2aWRlby9tcGVnXCI7XG5cdFx0Y2FzZSBcIi5tcGtnXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3ZuZC5hcHBsZS5pbnN0YWxsZXIreG1sXCI7XG5cdFx0Y2FzZSBcIi5vZHBcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC5wcmVzZW50YXRpb25cIjtcblx0XHRjYXNlIFwiLm9kc1wiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQub2FzaXMub3BlbmRvY3VtZW50LnNwcmVhZHNoZWV0XCI7XG5cdFx0Y2FzZSBcIi5vZHRcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vdm5kLm9hc2lzLm9wZW5kb2N1bWVudC50ZXh0XCI7XG5cdFx0Y2FzZSBcIi5vZ2FcIjogcmV0dXJuIFwiYXVkaW8vb2dnXCI7XG5cdFx0Y2FzZSBcIi5vZ3ZcIjogcmV0dXJuIFwidmlkZW8vb2dnXCI7XG5cdFx0Y2FzZSBcIi5vZ3hcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vb2dnXCI7XG5cdFx0Y2FzZSBcIi5vcHVzXCI6IHJldHVybiBcImF1ZGlvL29wdXNcIjtcblx0XHRjYXNlIFwiLm90ZlwiOiByZXR1cm4gXCJmb250L290ZlwiO1xuXHRcdGNhc2UgXCIucG5nXCI6IHJldHVybiBcImltYWdlL3BuZ1wiO1xuXHRcdGNhc2UgXCIucGRmXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3BkZlwiO1xuXHRcdGNhc2UgXCIucGhwXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3BocFwiO1xuXHRcdGNhc2UgXCIucHB0XCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3ZuZC5tcy1wb3dlcnBvaW50XCI7XG5cdFx0Y2FzZSBcIi5wcHR4XCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5wcmVzZW50YXRpb25tbC5wcmVzZW50YXRpb25cIjtcblx0XHRjYXNlIFwiLnJhclwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQucmFyXCI7XG5cdFx0Y2FzZSBcIi5ydGZcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vcnRmXCI7XG5cdFx0Y2FzZSBcIi5zaFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LXNoXCI7XG5cdFx0Y2FzZSBcIi5zdmdcIjogcmV0dXJuIFwiaW1hZ2Uvc3ZnK3htbFwiO1xuXHRcdGNhc2UgXCIuc3dmXCI6IHJldHVybiBcImFwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoXCI7XG5cdFx0Y2FzZSBcIi50YXJcIjogcmV0dXJuIFwiYXBwbGljYXRpb24veC10YXJcIjtcblx0XHRjYXNlIFwiLnRpZlwiOiByZXR1cm4gXCJpbWFnZS90aWZmXCI7XG5cdFx0Y2FzZSBcIi50aWZmXCI6IHJldHVybiBcImltYWdlL3RpZmZcIjtcblx0XHRjYXNlIFwiLnRzXCI6IHJldHVybiBcInZpZGVvL21wMnRcIjtcblx0XHRjYXNlIFwiLnR0ZlwiOiByZXR1cm4gXCJmb250L3R0ZlwiO1xuXHRcdGNhc2UgXCIudHh0XCI6IHJldHVybiBcInRleHQvcGxhaW5cIjtcblx0XHRjYXNlIFwiLnZzZFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQudmlzaW9cIjtcblx0XHRjYXNlIFwiLndhdlwiOiByZXR1cm4gXCJhdWRpby93YXZcIjtcblx0XHRjYXNlIFwiLndlYmFcIjogcmV0dXJuIFwiYXVkaW8vd2VibVwiO1xuXHRcdGNhc2UgXCIud2VibVwiOiByZXR1cm4gXCJ2aWRlby93ZWJtXCI7XG5cdFx0Y2FzZSBcIi53ZWJwXCI6IHJldHVybiBcImltYWdlL3dlYnBcIjtcblx0XHRjYXNlIFwiLndvZmZcIjogcmV0dXJuIFwiZm9udC93b2ZmXCI7XG5cdFx0Y2FzZSBcIi53b2ZmMlwiOiByZXR1cm4gXCJmb250L3dvZmYyXCI7XG5cdFx0Y2FzZSBcIi54aHRtbFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94aHRtbCt4bWxcIjtcblx0XHRjYXNlIFwiLnhsc1wiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQubXMtZXhjZWxcIjtcblx0XHRjYXNlIFwiLnhsc3hcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vdm5kLm9wZW54bWxmb3JtYXRzLW9mZmljZWRvY3VtZW50LnNwcmVhZHNoZWV0bWwuc2hlZXRcIjtcblx0XHRjYXNlIFwiLnhtbFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94bWxcIjtcblx0XHRjYXNlIFwiLnh1bFwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi92bmQubW96aWxsYS54dWwreG1sXCI7XG5cdFx0Y2FzZSBcIi56aXBcIjogcmV0dXJuIFwiYXBwbGljYXRpb24vemlwXCI7XG5cdFx0Y2FzZSBcIi4zZ3BcIjogcmV0dXJuIFwidmlkZW8vM2dwcFwiO1xuXHRcdGNhc2UgXCIuM2cyXCI6IHJldHVybiBcInZpZGVvLzNncHAyXCI7XG5cdFx0Y2FzZSBcIi43elwiOiByZXR1cm4gXCJhcHBsaWNhdGlvbi94LTd6LWNvbXByZXNzZWRcIjtcblx0fVxuXHRcblx0dGhyb3cgbmV3IEVycm9yKFwiRmlsZSBleHRlbnNpb24gaGFzIG5vIGtub3duIG1pbWV0eXBlXCIpO1xufVxuXG5cbi8qKlxuICogRW5jb2RlcyBhIFVpbnQ4QXJyYXkgaW50byBhIGJhc2U2NCBzdHJpbmdcbiAqXG4gKiBAcHJpdmF0ZVxuICpcbiAqIEBwYXJhbSB7YW55fSB1aW50OGFyciBhIFVpbnQ4QXJyYXlcbiAqIEByZXR1cm5zIHtzdHJpbmd9IGEgYmFzZTY0IGVuY29kZWQgc3RyaW5nIFxuICovXG5mdW5jdGlvbiBfZW5jb2RlVThpbnRUb0Jhc2U2NFN0cmluZyh1aW50OGFycjogYW55KSA6IHN0cmluZyB7XG5cdGNvbnN0IENIVU5LX1NJWkUgPSAweDgwMDA7XG5cdFxuXHRjb25zdCBjaGFyQXJyYXk6IHN0cmluZ1tdID0gW107XG5cdFxuXHRmb3IgKGxldCBpID0gMDsgaSA8IHVpbnQ4YXJyLmxlbmd0aDsgaSArPSBDSFVOS19TSVpFKSB7XG5cdFx0Y2hhckFycmF5LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCB1aW50OGFyci5zdWJhcnJheShpLCBpICsgQ0hVTktfU0laRSkpKTtcblx0fVxuXHRcblx0cmV0dXJuIGJ0b2EoY2hhckFycmF5LmpvaW4oXCJcIikpO1xufVxuXG5cbi8qKlxuICogQ29udmVydHMgYSBzdHJpbmcgdG8gYSBVaW50OEFycmF5XG4gKlxuICogQHByaXZhdGVcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIGEgc3RyaW5nXG4gKiBAcmV0dXJucyB7VWludDhBcnJheX0gYSBVaW50OEFycmF5IGZyb20gdGhlIHN0cmluZyBcbiAqL1xuZnVuY3Rpb24gX2NvbnZlcnRTdHJpbmdUb1VpbnQ4KHN0cjogc3RyaW5nKSA6IFVpbnQ4QXJyYXkge1xuXHRyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHN0cikpXG59XG5cblxuLyoqXG4gKiBEZWNvZGVzIGEgVUludDhBcnJheSB0aGF0IGNvbnRhaW5zIGJhc2U2NCBkYXRhIGludG8gYSBiYXNlNjQgZGVjb2RlZCBzdHJpbmdcbiAqXG4gKiBAcHJpdmF0ZVxuICpcbiAqIEBwYXJhbSB7VWludDhBcnJheX0gYnl0ZXMgYSBVaW50OEFycmF5IHRoYXQgY29udGFpbnMgYmFzZTY0IGVuY29kZWQgZGF0YVxuICogQHJldHVybnMge3N0cmluZ30gYW4gYmFzZTY0IHVuZW5jb2RlZCBzdHJpbmcgXG4gKi9cbmZ1bmN0aW9uIF9kZWNvZGVCYXNlNjRCeXRlcyhieXRlczogVWludDhBcnJheSkgOiBzdHJpbmcge1xuXHRyZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKFVpbnQ4QXJyYXkuZnJvbShhdG9iKG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShieXRlcykpLCBjID0+IGMuY2hhckNvZGVBdCgwKSkpXG59XG5cblxuLyoqXG4gKiBEZWNvZGVzIGEgVWludDhBcnJheSB0aGF0IGNvbnRhaW5zIGJhc2U2NCBkYXRhIGludG8gYSBiYXNlNjQgZGVjb2RlZCBVaW50OEFycmF5XG4gKlxuICogQHByaXZhdGVcbiAqXG4gKiBAcGFyYW0ge1VpbnQ4QXJyYXl9IGJ5dGVzIGEgVWludDhBcnJheSB0aGF0IGNvbnRhaW5zIGJhc2U2NCBlbmNvZGVkIGRhdGFcbiAqIEByZXR1cm5zIHtVaW50OEFycmF5fSBhbiBiYXNlNjQgdW5lbmNvZGVkIFVpbnQ4QXJyYXkgXG4gKi9cbmZ1bmN0aW9uIF9kZWNvZGVCYXNlNjRCeXRlc1RvVWludDgoYnl0ZXM6IFVpbnQ4QXJyYXkpIDogVWludDhBcnJheSB7XG5cdHJldHVybiBVaW50OEFycmF5LmZyb20oYXRvYihuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoYnl0ZXMpKSwgYyA9PiBjLmNoYXJDb2RlQXQoMCkpO1xufVxuXG5cblxuLyoqXG4gKiBUaGlzIGNsYXNzIHByb3ZpZGVzIGFuIGVhc3kgaW50ZXJmYWNlIHRvIHBlcmZvcm0gYmFzZTY0IGVuY29kaW5nIG9uIHN0cmluZ3NcbiAqIGFuZCBmaWxlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEJhc2U2NCB7XG5cdFxuXHRwcml2YXRlIGJ5dGVzOiBVaW50OEFycmF5O1xuXHRwcml2YXRlIG1pbWU6IHN0cmluZztcblx0cHJpdmF0ZSBpc0Jhc2U2NEVuY29kZWQ6IGJvb2xlYW47XG5cdFxuXHRwdWJsaWMgY29uc3RydWN0b3IoZGF0YTogYW55KSB7XG5cdFx0dGhpcy5ieXRlcyA9IGRhdGEuYnl0ZXM7XG5cdFx0dGhpcy5taW1lID0gZGF0YS5taW1lO1xuXHRcdHRoaXMuaXNCYXNlNjRFbmNvZGVkID0gZGF0YS5pc0Jhc2U2NEVuY29kZWQ7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQ3JlYXRlcyBhIEJhc2U2NCBvYmplY3QgZnJvbSBhIHN0cmluZ1xuXHQgKlxuXHQgKiBAcHVibGljXG5cdCAqIEBzdGF0aWNcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IHVuZW5jb2RlZFN0cmluZyBhIHN0cmluZyB0aGF0IHdpbGwgYmUgYmFzZTY0IGVuY29kZWRcblx0ICogQHJldHVybnMge0Jhc2U2NH0gYSBCYXNlNjQgb2JqZWN0XG5cdCAqL1xuXHRwdWJsaWMgc3RhdGljIGZyb21TdHJpbmcodW5lbmNvZGVkU3RyaW5nOiBzdHJpbmcpIDogQmFzZTY0IHtcblx0XHRyZXR1cm4gbmV3IEJhc2U2NCh7XG5cdFx0XHRieXRlczogX2NvbnZlcnRTdHJpbmdUb1VpbnQ4KHVuZW5jb2RlZFN0cmluZyksXG5cdFx0XHRtaW1lOiBudWxsLFxuXHRcdFx0aXNCYXNlNjRFbmNvZGVkOiBmYWxzZSxcblx0XHR9KTtcblx0fVxuXHRcblx0XG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgQmFzZTY0IG9iamVjdCBmcm9tIGFuIGFscmVhZHkgYmFzZTY0IGVuY29kZWQgc3RyaW5nXG5cdCAqXG5cdCAqIEBwdWJsaWNcblx0ICogQHN0YXRpY1xuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZW5jb2RlZFN0cmluZyBhIHN0cmluZyB0aGF0IGlzIGFscmVhZHkgYmFzZTY0IGVuY29kZWRcblx0ICogQHJldHVybnMge0Jhc2U2NH0gYSBCYXNlNjQgb2JqZWN0XG5cdCAqL1xuXHRwdWJsaWMgc3RhdGljIGZyb21CYXNlNjRTdHJpbmcoZW5jb2RlZFN0cmluZzogc3RyaW5nKSA6IEJhc2U2NCB7XG5cdFx0cmV0dXJuIG5ldyBCYXNlNjQoe1xuXHRcdFx0Ynl0ZXM6IF9jb252ZXJ0U3RyaW5nVG9VaW50OChlbmNvZGVkU3RyaW5nKSxcblx0XHRcdG1pbWU6IG51bGwsXG5cdFx0XHRpc0Jhc2U2NEVuY29kZWQ6IHRydWUsXG5cdFx0fSk7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQ3JlYXRlcyBhIEJhc2U2NCBvYmplY3QgZnJvbSBhIFVpbnQ4QXJyYXlcblx0ICpcblx0ICogQHB1YmxpY1xuXHQgKiBAc3RhdGljXG5cdCAqXG5cdCAqIEBwYXJhbSB7VWludDhBcnJheX0gdWludDhhcnIgYSBVaW50OEFycmF5IHRoYXQgd2lsbCBiZSBiYXNlNjQgZW5jb2RlZFxuXHQgKiBAcmV0dXJucyB7QmFzZTY0fSBhIEJhc2U2NCBvYmplY3Rcblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgZnJvbVVpbnQ4QXJyYXkodWludDhhcnI6IFVpbnQ4QXJyYXkpIDogQmFzZTY0IHtcblx0XHRyZXR1cm4gbmV3IEJhc2U2NCh7XG5cdFx0XHRieXRlczogdWludDhhcnIsXG5cdFx0XHRtaW1lOiBudWxsLFxuXHRcdFx0aXNCYXNlNjRFbmNvZGVkOiBmYWxzZSxcblx0XHR9KTtcblx0fVxuXHRcblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIEJhc2U2NCBvYmplY3QgZnJvbSBhIGJhc2U2NCBlbmNvZGVkIFVpbnQ4QXJyYXlcblx0ICpcblx0ICogQHB1YmxpY1xuXHQgKiBAc3RhdGljXG5cdCAqXG5cdCAqIEBwYXJhbSB7VWludDhBcnJheX0gdWludDhhcnIgYSBVaW50OEFycmF5IHRoYXQgY29udGFpbnMgYmFzZTY0IGVuY29kZWQgZGF0YVxuXHQgKiBAcmV0dXJucyB7QmFzZTY0fSBhIEJhc2U2NCBvYmplY3Rcblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgZnJvbUJhc2U2NFVpbnQ4QXJyYXkodWludDhhcnI6IFVpbnQ4QXJyYXkpIDogQmFzZTY0IHtcblx0XHRyZXR1cm4gbmV3IEJhc2U2NCh7XG5cdFx0XHRieXRlczogdWludDhhcnIsXG5cdFx0XHRtaW1lOiBudWxsLFxuXHRcdFx0aXNCYXNlNjRFbmNvZGVkOiB0cnVlLFxuXHRcdH0pO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBCYXNlNjQgb2JqZWN0IGZyb20gdGhlIGNvbnRlbnRzIG9mIGEgZmlsZVxuXHQgKlxuXHQgKiBAcHVibGljXG5cdCAqIEBzdGF0aWNcblx0ICpcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZpbGVQYXRoIHRoZSBwYXRoIHRvIGEgZmlsZSB0aGF0IHdpbGwgYmUgYmFzZTY0IGVuY29kZWRcblx0ICogQHJldHVybnMge0Jhc2U2NH0gYSBCYXNlNjQgb2JqZWN0XG5cdCAqL1xuXHRwdWJsaWMgc3RhdGljIGZyb21GaWxlKGZpbGVQYXRoOiBzdHJpbmcpIDogQmFzZTY0IHtcblx0XHRyZXR1cm4gbmV3IEJhc2U2NCh7XG5cdFx0XHRieXRlczogRGVuby5yZWFkRmlsZVN5bmMoZmlsZVBhdGgpLFxuXHRcdFx0bWltZTogYGRhdGE6JHtfZGV0ZXJtaW5lTWltZVR5cGUoZmlsZVBhdGgpfTtiYXNlNjQsYCxcblx0XHRcdGlzQmFzZTY0RW5jb2RlZDogZmFsc2UsXG5cdFx0fSk7XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogQ3JlYXRlcyBhIEJhc2U2NCBvYmplY3QgZnJvbSB0aGUgY29udGVudHMgb2YgYW4gYWxyZWFkeSBiYXNlNjQgZW5jb2RlZCBmaWxlXG5cdCAqXG5cdCAqIEBwdWJsaWNcblx0ICogQHN0YXRpY1xuXHQgKlxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZmlsZVBhdGggdGhlIHBhdGggdG8gYSBmaWxlIHRoYXQgd2lsbCBiZSBiYXNlNjQgZGVjb2RlZFxuXHQgKiBAcmV0dXJucyB7QmFzZTY0fSBhIEJhc2U2NCBvYmplY3Rcblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgZnJvbUJhc2U2NEZpbGUoZmlsZVBhdGg6IHN0cmluZykgOiBCYXNlNjQge1xuXHRcdHJldHVybiBuZXcgQmFzZTY0KHtcblx0XHRcdGJ5dGVzOiBEZW5vLnJlYWRGaWxlU3luYyhmaWxlUGF0aCksXG5cdFx0XHRtaW1lOiBudWxsLFxuXHRcdFx0aXNCYXNlNjRFbmNvZGVkOiB0cnVlLFxuXHRcdH0pO1xuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIFJldHVybnMgdGhlIGJhc2U2NCBlbmNvZGVkIHN0cmluZyBmcm9tIHRoZSBCYXNlNjQgb2JqZWN0XG5cdCAqXG5cdCAqIEBwdWJsaWNcblx0ICpcblx0ICogQHJldHVybnMge0Jhc2U2NH0gYSBiYXNlNjQgZW5jb2RlZCBzdHJpbmdcblx0ICovXG5cdHB1YmxpYyB0b1N0cmluZygpIDogc3RyaW5nIHtcblx0XHRpZiAodGhpcy5pc0Jhc2U2NEVuY29kZWQpIHtcblx0XHRcdHJldHVybiBfZGVjb2RlQmFzZTY0Qnl0ZXModGhpcy5ieXRlcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBfZW5jb2RlVThpbnRUb0Jhc2U2NFN0cmluZyh0aGlzLmJ5dGVzKTtcblx0XHR9XG5cdH1cblx0XG5cdFxuXHQvKipcblx0ICogUmV0dXJucyB0aGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nIGZyb20gdGhlIEJhc2U2NCBvYmplY3QsIHdpdGggdGhlXG5cdCAqIGluY2x1c2lvbiBvZiB0aGUgTUlNRSB0eXBlIGlmIHRoZSBCYXNlNjQgb2JqZWN0IHdhcyBjcmVhdGVkIGZyb20gYSBmaWxlXG5cdCAqIChhbmQgaWYgbm90IGNyZWF0ZWQgZnJvbSBhIGZpbGUsIHdvcmtzIHRoZSBzYW1lIGFzIHRoZSAudG9TdHJpbmcoKSBtZXRob2QpXG5cdCAqXG5cdCAqIEBwdWJsaWNcblx0ICpcblx0ICogQHJldHVybnMge3N0cmluZ30gYSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcgd2l0aCBNSU1FIHR5cGUgaW5jbHVkZWQgd2hlbiBmcm9tIGEgZmlsZVxuXHQgKi9cblx0cHVibGljIHRvU3RyaW5nV2l0aE1pbWUoKSA6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMubWltZSkge1xuXHRcdFx0aWYgKHRoaXMuaXNCYXNlNjRFbmNvZGVkKSB7XG5cdFx0XHRcdHJldHVybiBfZGVjb2RlQmFzZTY0Qnl0ZXModGhpcy5ieXRlcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5taW1lICsgX2VuY29kZVU4aW50VG9CYXNlNjRTdHJpbmcodGhpcy5ieXRlcyk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRoaXMuaXNCYXNlNjRFbmNvZGVkKSB7XG5cdFx0XHRcdHJldHVybiBfZGVjb2RlQmFzZTY0Qnl0ZXModGhpcy5ieXRlcyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gX2VuY29kZVU4aW50VG9CYXNlNjRTdHJpbmcodGhpcy5ieXRlcyk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIFdyaXRlcyB0aGUgYmFzZTY0IHN0cmluZyBmcm9tIHRoZSBCYXNlNjQgb2JqZWN0IHRvIGEgZmlsZVxuXHQgKlxuXHQgKiBAcHVibGljXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlUGF0aCB0aGUgcGF0aCB0byB0aGUgZmlsZSB0aGF0IHRoZSBCYXNlNjQgY29udGVudHMgd2lsbCBiZSB3cml0dGVuIHRvXG5cdCAqL1xuXHRwdWJsaWMgdG9GaWxlKGZpbGVQYXRoOiBzdHJpbmcpIDogdm9pZCB7XG5cdFx0aWYgKHRoaXMuaXNCYXNlNjRFbmNvZGVkKSB7XG5cdFx0XHREZW5vLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIF9kZWNvZGVCYXNlNjRCeXRlc1RvVWludDgodGhpcy5ieXRlcykpXG5cdFx0fSBlbHNlIHtcblx0XHRcdERlbm8ud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKF9lbmNvZGVVOGludFRvQmFzZTY0U3RyaW5nKHRoaXMuYnl0ZXMpKSk7XG5cdFx0fVxuXHR9XG5cdFxuXHRcblx0LyoqXG5cdCAqIFdyaXRlcyB0aGUgYmFzZTY0IHN0cmluZyBmcm9tIHRoZSBCYXNlNjQgb2JqZWN0IHRvIGEgZmlsZSwgaW5jbHVkaW5nIHRoZVxuXHQgKiBNSU1FIHR5cGUgd2hlbiB3cml0aW5nIHRvIHRoZSBmaWxlLlxuXHQgKlxuXHQgKiBAcHVibGljXG5cdCAqXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlUGF0aCB0aGUgcGF0aCB0byB0aGUgZmlsZSB0aGF0IHRoZSBCYXNlNjQgY29udGVudHMgd2lsbCBiZSB3cml0dGVuIHRvXG5cdCAqL1xuXHRwdWJsaWMgdG9GaWxlV2l0aE1pbWUoZmlsZVBhdGg6IHN0cmluZykgOiB2b2lkIHtcblx0XHRpZiAoIXRoaXMubWltZSkge1xuXHRcdFx0dGhpcy50b0ZpbGUoZmlsZVBhdGgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHREZW5vLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZSh0aGlzLm1pbWUgKyBfZW5jb2RlVThpbnRUb0Jhc2U2NFN0cmluZyh0aGlzLmJ5dGVzKSkpO1xuXHRcdH1cblx0fVxufSJdfQ==